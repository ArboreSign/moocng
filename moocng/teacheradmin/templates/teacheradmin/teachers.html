{% extends "teacheradmin/base_teacheradmin.html" %}

{% load i18n gravatar %}

{% block nav-teacheradmin-teachers %}active{% endblock %}

{% block extraheader %}
<script src="{{ STATIC_URL }}js/libs/underscore-1.3.3.min.js" type="text/javascript"></script>
<script type="text/javascript">
$(document).ready(function () {
    $("#invite-teacher").typeahead({
        source: function (query, process) {
            $.getJSON("/api/v1/user/", {
                    format: "json",
                    first_name__istartswith: query,
                    last_name__istartswith: query
                },
                function (data, textStatus, jqXHR) {
                    process(_.map(data.objects, function (user) {
                        return user.first_name + " " + user.last_name;
                    }));
                }
            );
        },
        updater: function (item) {
            this.$element.val(item);
            // TODO doesn't work
        },
        minLength: 1
    });
});
</script>
{% endblock %}

{% block section %}
<h2>{% trans "Teachers" %}</h2>
<table class="table table-striped">
    <tbody>
        {% for teacher in course.teachers.all %}
        <tr>
            <td>{% gravatar_img_for_user teacher 20 %}</td>
            <td>{% firstof teacher.get_full_name teacher.username %} <a href="mailto:{{ teacher.email }}">&lt;{{ teacher.email }}&gt;</a></td>
            <td></td> <!-- TODO pending badge via templatetag -->
            <td style="text-align: right;"><i class="icon-remove pointer"></i></td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<form action="{{ request.path }}invite" method="post" class="form-inline">
    <fieldset>
        <div class="input-append">
            <input id="invite-teacher" class="input-xlarge" type="text" autocomplete="off" placeholder="{% trans "Name or email" %}" />
            <input type="submit" class="btn" value="{% trans "Add" %}" />
        </div>
    </fieldset>
</form>
{% endblock %}
